<!doctype html>
<html>
<head>
  <meta charset="utf-8">
  <script src="https://unpkg.com/@webcomponents/webcomponentsjs@2.5.0/webcomponents-loader.js"></script>
  <script src="https://unpkg.com/wct-browser-legacy@1.0.2/browser.js"></script>
</head>

<body>
  <script type="module">
    import { calculateColor } from '../utils.js';

    suite('calculateColor', () => {
      test('should return pure red for a score of 0', () => {
        const expected = ['rgb(250, 0, 0)', 'rgba(250, 0, 0, 0.15)'];
        assert.deepEqual(calculateColor(0), expected);
      });

      test('should return pure green for a score of 100', () => {
        const expected = ['rgb(0, 160, 0)', 'rgba(0, 160, 0, 0.15)'];
        assert.deepEqual(calculateColor(100), expected);
      });

      test('should return the exact color for a gradient stop (Orange)', () => {
        const expected = ['rgb(250, 125, 0)', 'rgba(250, 125, 0, 0.15)'];
        assert.deepEqual(calculateColor(33.33), expected);
      });

      test('should return the exact color for a gradient stop (Yellow)', () => {
        const expected = ['rgb(220, 220, 0)', 'rgba(220, 220, 0, 0.15)'];
        assert.deepEqual(calculateColor(66.67), expected);
      });

      test('should return a color halfway between red and orange', () => {
        // Midpoint score: (0 + 33.33) / 2 = 16.665
        // Red component: round(250 * 0.5 + 250 * 0.5) = 250
        // Green component: round(0 * 0.5 + 125 * 0.5) = 63
        // Blue component: round(0 * 0.5 + 0 * 0.5) = 0
        const expected = ['rgb(250, 63, 0)', 'rgba(250, 63, 0, 0.15)'];
        assert.deepEqual(calculateColor(16.665), expected);
      });

      test('should return a color at an arbitrary point between orange and yellow', () => {
        // weight = (50 - 33.33) / (66.67 - 33.33) = 16.67 / 33.34 â‰ˆ 0.5
        // Let w = 16.67 / 33.34
        // R = round(250 * (1-w) + 220 * w) = round(125.025 + 109.989) = 235
        // G = round(125 * (1-w) + 220 * w) = round(62.5125 + 109.989) = 173
        // B = round(0 * (1-w) + 0 * w) = 0
        const expected = ['rgb(235, 173, 0)', 'rgba(235, 173, 0, 0.15)'];
        assert.deepEqual(calculateColor(50), expected);
      });

      test('should return a color halfway between yellow and green', () => {
        // Midpoint score: (66.67 + 100) / 2 = 83.335
        // R: round(220 * 0.5 + 0 * 0.5) = 110
        // G: round(220 * 0.5 + 160 * 0.5) = 190
        // B: round(0 * 0.5 + 0 * 0.5) = 0
        const expected = ['rgb(110, 190, 0)', 'rgba(110, 190, 0, 0.15)'];
        assert.deepEqual(calculateColor(83.335), expected);
      });
    });
  </script>
</body>
</html>